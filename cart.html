// Khi trang load, cập nhật giỏ hàng
window.onload = updateCartDisplay;

// Xử lý nút "Thanh toán"
document.getElementById("checkout-btn").onclick = function () {
    if (cart.length === 0) {
        alert("Giỏ hàng của bạn đang trống!");
        return;
    }

    const confirmCheckout = confirm("Bạn có chắc chắn muốn thanh toán?");
    if (!confirmCheckout) return;

    // Hiện popup chọn hình thức gửi
    document.getElementById("send-options").style.display = "flex";
};

// Hàm gửi đơn hàng theo phương thức người dùng chọn
function sendOrder(method) {
    let message = "🛒 Đơn hàng của bạn:\n";
    let total = 0;

    cart.forEach(item => {
        message += `- ${item.name} x ${item.quantity}\n`;
        total += item.price * item.quantity;
    });

    message += `\n💰 Tổng cộng: ${total.toLocaleString()} đ`;
    const encodedMessage = encodeURIComponent(message);

    // Ẩn popup
    document.getElementById("send-options").style.display = "none";

    // Mở ứng dụng tương ứng
    if (method === "zalo") {
        alert("Bạn sẽ được chuyển sang Zalo để gửi đơn.");
        window.open("https://zalo.me/", "_blank");
    } else if (method === "messenger") {
        alert("Bạn sẽ được chuyển sang Messenger để gửi đơn.");
        window.open("https://m.me/", "_blank");
    } else if (method === "telegram") {
        window.open(`https://t.me/share/url?url=&text=${encodedMessage}`, "_blank");
    }

    // Xóa giỏ hàng
    cart = [];
    localStorage.removeItem("cart");
    updateCartDisplay();
}
