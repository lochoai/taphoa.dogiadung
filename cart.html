<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Giỏ hàng của bạn</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>Giỏ Hàng Của Bạn</h1>
        <nav>
            <a href="index.html">← Quay lại mua hàng</a>
        </nav>
    </header>

    <main>
        <h2>Giỏ hàng của bạn</h2>
<table id="cart-table">
    <thead>
        <tr>
            <th>Tên sản phẩm</th>
            <th>Đơn giá</th>
            <th>Số lượng</th>
            <th>Thành tiền</th>
            <th></th> <!-- Cột Xóa -->
        </tr>
    </thead>
    <tbody id="cart-items"></tbody>
</table>

<p class="total-line"><strong>Tổng cộng: </strong><span id="cart-total">0</span> đ</p>
<button id="checkout-btn">Thanh toán</button>

    </main>

    <footer>
        <p>&copy; 2025 Cửa hàng Tạp hóa</p>
    </footer>

    <script>
        // Đọc dữ liệu từ localStorage
        let cart = JSON.parse(localStorage.getItem('cart')) || [];

        function removeFromCart(index) {
    cart.splice(index, 1);
    saveCart();
    updateCartDisplay();
}
       function updateCartDisplay() {
    const cartItems = document.getElementById("cart-items");
    const cartTotal = document.getElementById("cart-total");

    cartItems.innerHTML = "";
    let total = 0;

    cart.forEach((item, index) => {
        const row = document.createElement("tr");

        // Tên sản phẩm
        const nameCell = document.createElement("td");
        nameCell.setAttribute("data-label", "Tên SP");
        nameCell.textContent = item.name;
        row.appendChild(nameCell);

        // Đơn giá
        const priceCell = document.createElement("td");
        priceCell.setAttribute("data-label", "Đơn giá");
        priceCell.textContent = item.price.toLocaleString() + " đ";
        row.appendChild(priceCell);

        // Số lượng với nút + và -
const quantityCell = document.createElement("td");
quantityCell.setAttribute("data-label", "Số lượng");

// Tạo nút -
const minusBtn = document.createElement("button");
minusBtn.textContent = "-";
minusBtn.style.marginRight = "8px";
minusBtn.onclick = () => {
    if (item.quantity > 1) {
        item.quantity--;
        localStorage.setItem("cart", JSON.stringify(cart));
        updateCartDisplay();
    }
};

// Hiển thị số lượng
const quantityText = document.createElement("span");
quantityText.textContent = item.quantity;

// Tạo nút +
const plusBtn = document.createElement("button");
plusBtn.textContent = "+";
plusBtn.style.marginLeft = "8px";
plusBtn.onclick = () => {
    item.quantity++;
    localStorage.setItem("cart", JSON.stringify(cart));
    updateCartDisplay();
};

// Thêm nút và số lượng vào ô
quantityCell.appendChild(minusBtn);
quantityCell.appendChild(quantityText);
quantityCell.appendChild(plusBtn);

row.appendChild(quantityCell);


        // Thành tiền
        const totalCell = document.createElement("td");
        totalCell.setAttribute("data-label", "Thành tiền");
        const itemTotal = item.price * item.quantity;
        total += itemTotal;
        totalCell.textContent = itemTotal.toLocaleString() + " đ";
        row.appendChild(totalCell);

        // Nút xóa
        const deleteCell = document.createElement("td");
        deleteCell.setAttribute("data-label", "Xóa");
        const deleteBtn = document.createElement("button");
        deleteBtn.textContent = "X";
        deleteBtn.style.color = "red";
        deleteBtn.onclick = () => removeFromCart(index);
        deleteCell.appendChild(deleteBtn);
        row.appendChild(deleteCell);

        cartItems.appendChild(row);
    });

    cartTotal.textContent = total.toLocaleString();
}



        // Gọi khi trang load
        window.onload = updateCartDisplay;
        document.getElementById("checkout-btn").onclick = function () {
    if (cart.length === 0) {
        alert("Giỏ hàng của bạn đang trống!");
        return;
    }

    const confirmCheckout = confirm("Bạn có chắc chắn muốn thanh toán?");
    if (confirmCheckout) {
        // Xử lý thanh toán (giả lập)
        alert("Cảm ơn bạn đã mua hàng! Đơn hàng của bạn đang được xử lý.");

        // Xóa giỏ hàng
        cart = [];
        localStorage.removeItem('cart');

        // Cập nhật lại giao diện
        updateCartDisplay();

        // Quay lại trang chủ sau 2 giây
        setTimeout(() => {
            window.location.href = "index.html";
        }, 2000);
    }
};

    </script>
</body>
</html>
